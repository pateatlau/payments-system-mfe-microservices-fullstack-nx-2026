// Admin Service Database Schema
// Database: admin_db (port 5434)
// 
// This schema defines the admin and audit logging data model.
// User references (userId, updatedBy) are stored as strings without foreign keys.
// User details are fetched via Auth Service API when needed.

generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/admin-client"
}

datasource db {
  provider = "postgresql"
  url      = env("ADMIN_DATABASE_URL")
}

model AuditLog {
  id           String   @id @default(uuid())
  userId       String?  @map("user_id")         // Reference to User ID (no FK)
  action       String
  resourceType String?  @map("resource_type")
  resourceId   String?  @map("resource_id")
  details      Json?
  ipAddress    String?  @map("ip_address")
  userAgent    String?  @map("user_agent")
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([userId])
  @@index([createdAt])
  @@index([action])
  @@map("audit_logs")
}

model SystemConfig {
  key         String   @id
  value       Json
  description String?
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at")
  updatedBy   String?  @map("updated_by")       // Reference to User ID (no FK)

  @@map("system_config")
}
